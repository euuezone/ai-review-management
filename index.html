<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ì—…ë¬´ í™œìš©í™” ë°©ì•ˆ ë¦¬ë·° ê´€ë¦¬ ì‹œíŠ¸</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        .tab-button.active {
            border-color: #3b82f6;
            color: #3b82f6;
            background-color: #eff6ff;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        th {
            position: sticky;
            top: 0;
            background-color: #f3f4f6;
            z-index: 10;
        }
        td {
            border-bottom: 1px solid #e5e7eb;
            padding: 12px 16px;
            min-width: 120px;
        }
        td[contenteditable="true"] {
            background-color: #f9fafb;
        }
        td[contenteditable="true"]:focus {
            outline: 2px solid #3b82f6;
            background-color: #eff6ff;
        }
        .form-question {
            margin-bottom: 1.5rem;
        }
        .form-label {
            display: block;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: #374151;
        }
        .form-radio-group {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
        }
        .form-radio-label {
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        .form-radio-input {
            margin-right: 0.5rem;
            height: 1rem;
            width: 1rem;
        }
        .form-textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            transition: border-color 0.2s;
        }
        .form-textarea:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 2px #bfdbfe;
        }
        .add-row-btn {
            background-color: #10b981;
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 500;
            margin-top: 12px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .add-row-btn:hover {
            background-color: #059669;
        }
        .delete-row-btn {
             opacity: 0;
             transition: opacity 0.2s;
             cursor: pointer;
        }
        tr:hover .delete-row-btn {
            opacity: 1;
        }
    </style>
</head>
<body class="bg-gray-100 p-4 sm:p-6 md:p-8">
    <div class="max-w-7xl mx-auto bg-white rounded-xl shadow-lg">
        <div class="p-6 border-b border-gray-200">
            <h1 class="text-2xl font-bold text-gray-800">AI ì—…ë¬´ í™œìš©í™” ë°©ì•ˆ ë¦¬ë·° ê´€ë¦¬ ì‹œíŠ¸</h1>
            <p class="text-sm text-gray-500 mt-1">í•µì‹¬ ëª©í‘œ(KPI) ë‹¬ì„± í˜„í™©ê³¼ AI í™œìš© ì‚¬ë¡€ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ í”„ë¡œì íŠ¸ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.</p>
        </div>

        <!-- Tab Buttons -->
        <div class="px-6 border-b border-gray-200">
            <nav class="flex flex-wrap -mb-px" aria-label="Tabs">
                <button onclick="changeTab(event, 'summary-dashboard')" class="tab-button active text-sm sm:text-base font-medium whitespace-nowrap px-3 py-3 border-b-2 border-transparent text-gray-500 hover:text-blue-600 hover:border-blue-300">
                    ìš”ì•½ ëŒ€ì‹œë³´ë“œ
                </button>
                 <button onclick="changeTab(event, 'team-progress')" class="tab-button text-sm sm:text-base font-medium whitespace-nowrap px-3 py-3 border-b-2 border-transparent text-gray-500 hover:text-blue-600 hover:border-blue-300">
                    í”„ë¡œì íŠ¸ ì ìš© ì‚¬ë¡€
                </button>
                <button onclick="changeTab(event, 'version-progress')" class="tab-button text-sm sm:text-base font-medium whitespace-nowrap px-3 py-3 border-b-2 border-transparent text-gray-500 hover:text-blue-600 hover:border-blue-300">
                    ë²„ì „ë³„ ì§„í–‰ ë‚´ìš©
                </button>
                <button onclick="changeTab(event, 'review-schedule')" class="tab-button text-sm sm:text-base font-medium whitespace-nowrap px-3 py-3 border-b-2 border-transparent text-gray-500 hover:text-blue-600 hover:border-blue-300">
                    ë¦¬ë·° ì¼ì • ê´€ë¦¬
                </button>
                <button onclick="changeTab(event, 'survey-status')" class="tab-button text-sm sm:text-base font-medium whitespace-nowrap px-3 py-3 border-b-2 border-transparent text-gray-500 hover:text-blue-600 hover:border-blue-300">
                    ë¦¬ë·° í›„ ì„¤ë¬¸ì¡°ì‚¬ ê´€ë¦¬
                </button>
                <button onclick="changeTab(event, 'survey-form')" class="tab-button text-sm sm:text-base font-medium whitespace-nowrap px-3 py-3 border-b-2 border-transparent text-gray-500 hover:text-blue-600 hover:border-blue-300">
                    ì„¤ë¬¸ì§€
                </button>
            </nav>
        </div>

        <!-- Tab Content -->
        <div class="p-4 sm:p-6">
            <!-- Sheet 0: ìš”ì•½ ëŒ€ì‹œë³´ë“œ -->
            <div id="summary-dashboard" class="tab-content active">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                    <!-- Card 1: KPI ë‹¬ì„± í˜„í™© -->
                    <div class="bg-blue-50 border border-blue-200 p-5 rounded-lg shadow-sm lg:col-span-2">
                        <h3 class="font-bold text-blue-800">í•µì‹¬ ëª©í‘œ(KPI) ë‹¬ì„± í˜„í™©</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6 mt-4">
                            <!-- KPI 1 -->
                            <div>
                                <h4 class="font-semibold text-gray-700">1) AI í™œìš© ë””ìì¸ ì—…ë¬´ ìë™í™”</h4>
                                <p class="text-sm text-gray-500 mt-1">ëª©í‘œ: í•´ë‹¹ ì—…ë¬´ ë¹„ìš© 30% ì´ìƒ ì ˆê°</p>
                                <div class="mt-3 bg-white p-4 rounded-md">
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm font-medium text-gray-600">í˜„ì¬ í‰ê·  ë¹„ìš© ì ˆê°ë¥ </span>
                                        <span id="kpi-cost-reduction" class="text-2xl font-bold text-blue-600">0%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2.5 mt-2">
                                        <div id="kpi-cost-reduction-bar" class="bg-blue-600 h-2.5 rounded-full transition-all duration-500" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            <!-- KPI 2 -->
                            <div>
                                <h4 class="font-semibold text-gray-700">2) AI í™œìš© ì—…ë¬´ íš¨ìœ¨í™” ë°©ì•ˆ ì „íŒŒ</h4>
                                <p class="text-sm text-gray-500 mt-1">ëª©í‘œ: êµ¬ì„±ì› 100% êµìœ¡ ì°¸ì—¬</p>
                                <div class="mt-3 bg-white p-4 rounded-md space-y-4">
                                    <div>
                                        <div class="flex justify-between mb-1">
                                            <span class="text-sm font-medium text-gray-600">v1.0 êµìœ¡ ì°¸ì—¬ìœ¨</span>
                                            <span class="text-sm font-medium text-green-700">100%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2.5">
                                            <div class="bg-green-600 h-2.5 rounded-full" style="width: 100%"></div>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="flex justify-between mb-1">
                                            <span class="text-sm font-medium text-gray-600">v1.1 êµìœ¡ ì°¸ì—¬ìœ¨</span>
                                            <span class="text-sm font-medium text-green-700">85%</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2.5">
                                            <div class="bg-green-600 h-2.5 rounded-full" style="width: 85%"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Card 2: ë¬¸ì„œ ë²„ì „ í˜„í™© -->
                     <div class="bg-gray-50 p-5 rounded-lg shadow">
                        <h3 class="font-bold text-gray-700 mb-4">ë¬¸ì„œ ë²„ì „ í˜„í™©</h3>
                        <div id="version-status-summary" class="space-y-4">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Card 3: ë²„ì „ë³„ ì¢…í•© í˜„í™© -->
                    <div class="bg-gray-50 p-5 rounded-lg shadow">
                        <h3 class="font-bold text-gray-700">ë²„ì „ë³„ ì¢…í•© í˜„í™©</h3>
                        <div class="space-y-6 mt-4">
                            <!-- v1.0 Status -->
                            <div>
                                <h4 class="font-semibold text-gray-600">v1.0 ë¦¬ë·° í˜„í™©</h4>
                                <div class="mt-3">
                                    <div class="flex justify-between mb-1">
                                        <span class="text-sm font-medium text-gray-500">ë¦¬ë·° ì§„í–‰ë¥  (2/2 íŒ€)</span>
                                        <span class="text-sm font-medium text-blue-700">100%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                                        <div class="bg-blue-600 h-2.5 rounded-full" style="width: 100%"></div>
                                    </div>
                                </div>
                                <div class="mt-4">
                                    <div class="flex justify-between mb-1">
                                        <span class="text-sm font-medium text-gray-500">ì„¤ë¬¸ ì°¸ì—¬ìœ¨ (2/4 ëª…)</span>
                                        <span class="text-sm font-medium text-green-700">50%</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                                        <div class="bg-green-600 h-2.5 rounded-full" style="width: 50%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                     <!-- Card 4: ìµœê·¼ í”„ë¡œì íŠ¸ ì ìš© ì‚¬ë¡€ -->
                    <div class="bg-gray-50 p-5 rounded-lg shadow">
                        <h3 class="font-bold text-gray-700">ìµœê·¼ í”„ë¡œì íŠ¸ ì ìš© ì‚¬ë¡€</h3>
                        <ul id="recent-cases-summary" class="mt-4 space-y-3">
                           <!-- Populated by JavaScript -->
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Sheet 1: í”„ë¡œì íŠ¸ ì ìš© ì‚¬ë¡€ -->
            <div id="team-progress" class="tab-content overflow-x-auto">
                <table id="case-study-table" class="w-full text-sm text-left text-gray-700">
                    <thead>
                        <tr>
                            <th class="px-4 py-3">ì ìš© ì—…ë¬´</th>
                            <th class="px-4 py-3">í™œìš© AI ë„êµ¬</th>
                            <th class="px-4 py-3">ê¸°ì¡´ ì†Œìš”ì‹œê°„(H)</th>
                            <th class="px-4 py-3">AI ë„ì… í›„ ì†Œìš”ì‹œê°„(H)</th>
                            <th class="px-4 py-3 font-bold text-blue-600">ì‹œê°„ ì ˆê°ë¥ (%)</th>
                            <th class="px-4 py-3">ë‹´ë‹¹ì/íŒ€</th>
                            <th class="px-4 py-3">ë“±ë¡ì¼</th>
                            <th class="px-4 py-3"></th>
                        </tr>
                    </thead>
                    <tbody><!-- Populated by JavaScript --></tbody>
                </table>
                <button class="add-row-btn" data-collection="project-cases">ì‚¬ë¡€ ì¶”ê°€</button>
            </div>
            
            <!-- Sheet 2: ë²„ì „ë³„ ì§„í–‰ ë‚´ìš© -->
            <div id="version-progress" class="tab-content overflow-x-auto">
                <table id="version-table" class="w-full text-sm text-left text-gray-700">
                    <thead>
                        <tr>
                            <th class="px-4 py-3">ë²„ì „</th>
                            <th class="px-4 py-3">ì—…ë°ì´íŠ¸ ì¼ì</th>
                            <th class="px-4 py-3 w-1/4">ì£¼ìš” ë³€ê²½ ì‚¬í•­</th>
                            <th class="px-4 py-3 w-1/3">ì£¼ìš” í”¼ë“œë°± ë° ì¡°ì¹˜ì‚¬í•­</th>
                            <th class="px-4 py-3">ë‹´ë‹¹ì</th>
                            <th class="px-4 py-3">ìƒíƒœ</th>
                             <th class="px-4 py-3"></th>
                        </tr>
                    </thead>
                    <tbody><!-- Populated by JavaScript --></tbody>
                </table>
                 <button class="add-row-btn" data-collection="versions">ë²„ì „ ì¶”ê°€</button>
            </div>

            <!-- Sheet 3: ë¦¬ë·° ì¼ì • ê´€ë¦¬ -->
            <div id="review-schedule" class="tab-content overflow-x-auto">
                <table id="schedule-table" class="w-full text-sm text-left text-gray-700">
                    <thead>
                        <tr>
                            <th class="px-4 py-3">íŒ€ëª…</th>
                            <th class="px-4 py-3">ë¦¬ë·° ì¼ì</th>
                            <th class="px-4 py-3">ë¦¬ë·° ì‹œê°„</th>
                            <th class="px-4 py-3">ë²„ì „</th>
                            <th class="px-4 py-3">ì£¼ìš” ë¦¬ë·° ë‚´ìš©</th>
                            <th class="px-4 py-3">ì°¸ì„ì</th>
                            <th class="px-4 py-3">ì§„í–‰ ìƒíƒœ</th>
                            <th class="px-4 py-3">ë¹„ê³ </th>
                             <th class="px-4 py-3"></th>
                        </tr>
                    </thead>
                    <tbody><!-- Populated by JavaScript --></tbody>
                </table>
                 <button class="add-row-btn" data-collection="schedules">ì¼ì • ì¶”ê°€</button>
            </div>

            <!-- Sheet 4: ë¦¬ë·° í›„ ì„¤ë¬¸ì¡°ì‚¬ ê´€ë¦¬ -->
            <div id="survey-status" class="tab-content overflow-x-auto">
                <table id="survey-table" class="w-full text-sm text-left text-gray-700">
                     <thead>
                        <tr>
                            <th class="px-6 py-3 text-left font-medium">íŒ€ëª…</th>
                            <th class="px-6 py-3 text-left font-medium">íŒ€ì›</th>
                            <th class="px-6 py-3 text-left font-medium">ì°¸ì—¬ ì—¬ë¶€</th>
                            <th class="px-6 py-3 text-left font-medium">ì œì¶œ ì¼ì</th>
                            <th class="px-6 py-3 text-left font-medium">ë¹„ê³ </th>
                             <th class="px-4 py-3"></th>
                        </tr>
                    </thead>
                    <tbody><!-- Populated by JavaScript --></tbody>
                </table>
                <button class="add-row-btn" data-collection="surveys">íŒ€ì› ì¶”ê°€</button>
            </div>
            
            <!-- Sheet 5: ì„¤ë¬¸ì§€ -->
            <div id="survey-form" class="tab-content">
                <div class="max-w-2xl mx-auto py-4">
                    <h2 class="text-xl font-bold text-gray-800 mb-2">AI ì—…ë¬´ í™œìš©í™” ë°©ì•ˆ ë¦¬ë·° í”¼ë“œë°± ì„¤ë¬¸</h2>
                    <p class="text-sm text-gray-600 mb-6">ì†Œì¤‘í•œ ì˜ê²¬ì„ í†µí•´ ë” ë‚˜ì€ ë°©í–¥ìœ¼ë¡œ ê°œì„ í•´ ë‚˜ê°€ê² ìŠµë‹ˆë‹¤.</p>
                    
                    <form onsubmit="event.preventDefault(); alert('ì„¤ë¬¸ì´ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤!'); this.reset();">
                        <div class="form-question">
                            <label class="form-label">1. ì˜¤ëŠ˜ ë¦¬ë·°ì— ëŒ€í•´ ì „ë°˜ì ìœ¼ë¡œ ì–¼ë§ˆë‚˜ ë§Œì¡±í•˜ì…¨ë‚˜ìš”?</label>
                            <div class="form-radio-group">
                                <label class="form-radio-label"><input type="radio" name="satisfaction" value="5" class="form-radio-input"> ë§¤ìš° ë§Œì¡±</label>
                                <label class="form-radio-label"><input type="radio" name="satisfaction" value="4" class="form-radio-input"> ë§Œì¡±</label>
                                <label class="form-radio-label"><input type="radio" name="satisfaction" value="3" class="form-radio-input"> ë³´í†µ</label>
                                <label class="form-radio-label"><input type="radio" name="satisfaction" value="2" class="form-radio-input"> ë¶ˆë§Œì¡±</label>
                                <label class="form-radio-label"><input type="radio" name="satisfaction" value="1" class="form-radio-input"> ë§¤ìš° ë¶ˆë§Œì¡±</label>
                            </div>
                        </div>

                        <div class="form-question">
                            <label class="form-label">2. AI ì—…ë¬´ í™œìš©í™” ë°©ì•ˆì˜ ë‚´ìš©ì„ ì–¼ë§ˆë‚˜ ì´í•´í•˜ì…¨ë‚˜ìš”?</label>
                            <div class="form-radio-group">
                                <label class="form-radio-label"><input type="radio" name="comprehension" value="5" class="form-radio-input"> ì™„ë²½íˆ ì´í•´í•¨</label>
                                <label class="form-radio-label"><input type="radio" name="comprehension" value="4" class="form-radio-input"> ëŒ€ë¶€ë¶„ ì´í•´í•¨</label>
                                <label class="form-radio-label"><input type="radio" name="comprehension" value="3" class="form-radio-input"> ë³´í†µ</label>
                                <label class="form-radio-label"><input type="radio" name="comprehension" value="2" class="form-radio-input"> ì¼ë¶€ ì´í•´í•˜ì§€ ëª»í•¨</label>
                                <label class="form-radio-label"><input type="radio" name="comprehension" value="1" class="form-radio-input"> ê±°ì˜ ì´í•´í•˜ì§€ ëª»í•¨</label>
                            </div>
                        </div>

                        <div class="form-question">
                            <label class="form-label">3. í˜„ì¬ ì—…ë¬´ì— AIë¥¼ ì–´ëŠì •ë„ í™œìš©í•˜ê³  ê³„ì‹ ê°€ìš”?</label>
                            <div class="form-radio-group">
                                <label class="form-radio-label"><input type="radio" name="usage" value="active" class="form-radio-input"> ì ê·¹ì ìœ¼ë¡œ í™œìš© ì¤‘</label>
                                <label class="form-radio-label"><input type="radio" name="usage" value="sometimes" class="form-radio-input"> ê°€ë” í™œìš© ì¤‘</label>
                                <label class="form-radio-label"><input type="radio" name="usage" value="experienced" class="form-radio-input"> í™œìš©í•´ ë³¸ ê²½í—˜ ìˆìŒ</label>
                                <label class="form-radio-label"><input type="radio" name="usage" value="none" class="form-radio-input"> ì•„ì§ í™œìš©í•´ ë³¸ ê²½í—˜ ì—†ìŒ</label>
                            </div>
                        </div>
                        
                        <div class="form-question">
                            <label for="current_workflow" class="form-label">4. í˜„ì¬ AIë¥¼ ì ìš©í•˜ê³  ìˆëŠ” ë³¸ì¸ì˜ ì—…ë¬´ ì›Œí¬í”Œë¡œìš°ë¥¼ ì„¤ëª…í•´ì£¼ì„¸ìš”.</label>
                            <textarea id="current_workflow" name="current_workflow" rows="4" class="form-textarea" placeholder="ì˜ˆ: ì£¼ê°„ ë³´ê³ ì„œ ì´ˆì•ˆ ì‘ì„± ì‹œ, ê´€ë ¨ ë°ì´í„°ë¥¼ ChatGPTì— ì…ë ¥í•˜ì—¬ ê°œìš”ì™€ í•µì‹¬ ìš”ì•½ ë¶€ë¶„ì„ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤."></textarea>
                        </div>

                        <div class="form-question">
                            <label for="future_workflow" class="form-label">5. AIë¥¼ ìƒˆë¡­ê²Œ ì ìš©í•´ë³´ê³  ì‹¶ê±°ë‚˜, ê°œì„ í•˜ê³  ì‹¶ì€ ë³¸ì¸ì˜ ì—…ë¬´ ì›Œí¬í”Œë¡œìš°ê°€ ìˆë‹¤ë©´ ì„¤ëª…í•´ì£¼ì„¸ìš”.</label>
                            <textarea id="future_workflow" name="future_workflow" rows="4" class="form-textarea" placeholder="ì˜ˆ: ê³ ê° ë¬¸ì˜ ì´ë©”ì¼ì— ëŒ€í•´ ìœ í˜•ë³„(ë‹¨ìˆœ ë¬¸ì˜, ë¶ˆë§Œ, ê¸°ìˆ  ì§€ì› ë“±)ë¡œ ìë™ ë¶„ë¥˜í•˜ê³ , ê° ìœ í˜•ì— ë§ëŠ” ë‹µë³€ í…œí”Œë¦¿ì„ ì¶”ì²œë°›ëŠ” ì›Œí¬í”Œë¡œìš°ë¥¼ ë§Œë“¤ê³  ì‹¶ìŠµë‹ˆë‹¤."></textarea>
                        </div>

                        <div class="form-question">
                            <label for="improvement" class="form-label">6. AI í™œìš© ë°©ì•ˆì´ë‚˜ ê´€ë ¨ ë„êµ¬ì—ì„œ ê°œì„ ì´ í•„ìš”í•˜ë‹¤ê³  ìƒê°í•˜ëŠ” ì ì„ ììœ ë¡­ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”.</label>
                            <textarea id="improvement" name="improvement" rows="4" class="form-textarea" placeholder="ì˜ˆ: ë°ì´í„° ë¶„ì„ ê²°ê³¼ì˜ ì‹œê°í™” ê¸°ëŠ¥ì´ ë” ë‹¤ì–‘í–ˆìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤."></textarea>
                        </div>

                        <div class="form-question">
                            <label for="etc" class="form-label">7. ê¸°íƒ€ ì˜ê²¬ì´ë‚˜ ì œì•ˆì‚¬í•­ì´ ìˆë‹¤ë©´ ììœ ë¡­ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”.</label>
                            <textarea id="etc" name="etc" rows="4" class="form-textarea" placeholder="ë¦¬ë·° ì§„í–‰ ë°©ì‹, ì‹œê°„ ë“± ì–´ë–¤ ì˜ê²¬ì´ë“  ì¢‹ìŠµë‹ˆë‹¤."></textarea>
                        </div>

                        <div class="text-right mt-8">
                            <button type="submit" class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition">
                                ì„¤ë¬¸ ì œì¶œí•˜ê¸°
                            </button>
                        </div>
                    </form>
                </div>
            </div>

        </div>
    </div>

    <script>
        // --- Tab Switching Logic ---
        window.changeTab = function(event, tabID) {
            let tabcontent = document.getElementsByClassName("tab-content");
            for (let i = 0; i < tabcontent.length; i++) {
                tabcontent[i].classList.remove('active');
            }

            let tablinks = document.getElementsByClassName("tab-button");
            for (let i = 0; i < tablinks.length; i++) {
                tablinks[i].classList.remove('active');
            }

            document.getElementById(tabID).classList.add('active');
            event.currentTarget.classList.add('active');
        }

        // --- Sample Data for Demo ---
        const sampleData = {
            'project-cases': [
                { task: 'ê´‘ê³  ë°°ë„ˆ 10ì¢… ì œì‘', tool: 'Midjourney', beforeTime: 20, afterTime: 8, owner: 'B-2íŒ€', date: '2024-07-28' },
                { task: 'ì£¼ê°„ ë³´ê³ ì„œ ì´ˆì•ˆ ì‘ì„±', tool: 'ChatGPT', beforeTime: 4, afterTime: 1, owner: 'A-1íŒ€', date: '2024-07-29' }
            ],
            'versions': [
                { version: 'v1.0', updateDate: '2024-07-20', changes: 'ì´ˆê¸° ë²„ì „ ë¦´ë¦¬ì¦ˆ', feedback: 'ì €ì‘ê¶Œ ê°€ì´ë“œë¼ì¸ ëª…í™•í™” ìš”ì²­', owner: 'ì „ì²´', status: 'ë°°í¬ ì™„ë£Œ' },
                { version: 'v1.1', updateDate: '2024-08-10', changes: 'ì±—ë´‡ ì‹œë‚˜ë¦¬ì˜¤ ì¶”ê°€', feedback: '', owner: 'A-1íŒ€', status: 'ë¦¬ë·° ì§„í–‰ ì¤‘' },
                { version: 'v2.0', updateDate: '', changes: 'ë°ì´í„° ì‹œê°í™” AI íˆ´ ì—°ë™', feedback: '', owner: 'C-3íŒ€', status: 'ê°œë°œ ì§„í–‰ ì¤‘' }
            ],
            'schedules': [
                { team: 'A-1íŒ€', reviewDate: '2024-08-12', reviewTime: '14:00', version: 'v1.1', topic: 'ì±—ë´‡ ì‹œë‚˜ë¦¬ì˜¤ ê°œì„ ', attendees: 'ê¹€ë¯¼ì¤€ ì™¸ 2ëª…', status: 'ì˜ˆì •', notes: '' }
            ],
            'surveys': [
                { team: 'A-1íŒ€', member: 'ê¹€ë¯¼ì¤€', status: 'ì°¸ì—¬', submissionDate: '2024-07-25', notes: '' },
                { team: 'A-1íŒ€', member: 'ì´ì„œì—°', status: 'ë¯¸ì°¸ì—¬', submissionDate: '', notes: 'íœ´ê°€' }
            ]
        };

        // --- Data Rendering Functions ---
        function renderProjectCases() {
            const tbody = document.querySelector('#case-study-table tbody');
            tbody.innerHTML = '';
            
            sampleData['project-cases'].forEach((item, index) => {
                const reduction = item.beforeTime > 0 ? (((item.beforeTime - item.afterTime) / item.beforeTime) * 100).toFixed(0) + '%' : '0%';
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td contenteditable="true">${item.task}</td>
                    <td contenteditable="true">${item.tool}</td>
                    <td contenteditable="true" class="text-center">${item.beforeTime}</td>
                    <td contenteditable="true" class="text-center">${item.afterTime}</td>
                    <td class="font-bold text-center">${reduction}</td>
                    <td contenteditable="true">${item.owner}</td>
                    <td contenteditable="true">${item.date}</td>
                    <td class="text-center"><button class="delete-row-btn" onclick="deleteRow(this, 'project-cases', ${index})">ğŸ—‘ï¸</button></td>
                `;
                tbody.appendChild(tr);
            });
            updateDashboard();
        }

        function renderVersions() {
            const tbody = document.querySelector('#version-table tbody');
            tbody.innerHTML = '';
            
            sampleData['versions'].forEach((item, index) => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td contenteditable="true">${item.version}</td>
                    <td contenteditable="true">${item.updateDate}</td>
                    <td contenteditable="true" class="w-1/4">${item.changes}</td>
                    <td contenteditable="true" class="w-1/3">${item.feedback}</td>
                    <td contenteditable="true">${item.owner}</td>
                    <td contenteditable="true">${item.status}</td>
                    <td class="text-center"><button class="delete-row-btn" onclick="deleteRow(this, 'versions', ${index})">ğŸ—‘ï¸</button></td>
                `;
                tbody.appendChild(tr);
            });
            updateVersionSummary();
        }

        function renderSchedules() {
            const tbody = document.querySelector('#schedule-table tbody');
            tbody.innerHTML = '';
            
            sampleData['schedules'].forEach((item, index) => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td contenteditable="true">${item.team}</td>
                    <td contenteditable="true">${item.reviewDate}</td>
                    <td contenteditable="true">${item.reviewTime}</td>
                    <td contenteditable="true">${item.version}</td>
                    <td contenteditable="true">${item.topic}</td>
                    <td contenteditable="true">${item.attendees}</td>
                    <td contenteditable="true">${item.status}</td>
                    <td contenteditable="true">${item.notes}</td>
                    <td class="text-center"><button class="delete-row-btn" onclick="deleteRow(this, 'schedules', ${index})">ğŸ—‘ï¸</button></td>
                `;
                tbody.appendChild(tr);
            });
        }

        function renderSurveys() {
            const tbody = document.querySelector('#survey-table tbody');
            tbody.innerHTML = '';
            
            sampleData['surveys'].forEach((item, index) => {
                const tr = document.createElement('tr');
                tr.className = item.status !== 'ì°¸ì—¬' ? 'bg-red-50' : '';
                tr.innerHTML = `
                    <td contenteditable="true">${item.team}</td>
                    <td contenteditable="true">${item.member}</td>
                    <td contenteditable="true">${item.status}</td>
                    <td contenteditable="true">${item.submissionDate}</td>
                    <td contenteditable="true">${item.notes}</td>
                    <td class="text-center"><button class="delete-row-btn" onclick="deleteRow(this, 'surveys', ${index})">ğŸ—‘ï¸</button></td>
                `;
                tbody.appendChild(tr);
            });
        }

        // --- Dashboard Update Functions ---
        function updateDashboard() {
            const rows = document.querySelectorAll('#case-study-table tbody tr');
            let totalReduction = 0;
            let validEntries = 0;

            rows.forEach(row => {
                const beforeTime = parseFloat(row.cells[2].textContent) || 0;
                const afterTime = parseFloat(row.cells[3].textContent) || 0;
                if (beforeTime > 0) {
                    totalReduction += ((beforeTime - afterTime) / beforeTime) * 100;
                    validEntries++;
                }
            });

            const averageReduction = validEntries > 0 ? (totalReduction / validEntries) : 0;
            const kpiValueEl = document.getElementById('kpi-cost-reduction');
            const kpiBarEl = document.getElementById('kpi-cost-reduction-bar');
            const kpiGoal = 30;

            if(kpiValueEl) kpiValueEl.textContent = averageReduction.toFixed(0) + '%';
            if(kpiBarEl) {
                const barPercentage = Math.min((averageReduction / kpiGoal) * 100, 100);
                kpiBarEl.style.width = barPercentage + '%';
            }
        }
        
        function updateVersionSummary() {
            const versionSummaryEl = document.getElementById('version-status-summary');
            if (!versionSummaryEl) return;
            versionSummaryEl.innerHTML = '';
            
            const statuses = ['ë°°í¬ ì™„ë£Œ', 'ë¦¬ë·° ì§„í–‰ ì¤‘', 'ê°œë°œ ì§„í–‰ ì¤‘'];
            const colors = {
                'ë°°í¬ ì™„ë£Œ': 'bg-green-100 text-green-800',
                'ë¦¬ë·° ì§„í–‰ ì¤‘': 'bg-yellow-100 text-yellow-800',
                'ê°œë°œ ì§„í–‰ ì¤‘': 'bg-blue-100 text-blue-800'
            };
            const labels = {
                'ë°°í¬ ì™„ë£Œ': 'ë°°í¬ ì™„ë£Œ ë²„ì „',
                'ë¦¬ë·° ì§„í–‰ ì¤‘': 'ë¦¬ë·° ì§„í–‰ ë²„ì „',
                'ê°œë°œ ì§„í–‰ ì¤‘': 'ê°œë°œ ì§„í–‰ ë²„ì „'
            };

            const allVersions = Array.from(document.querySelectorAll('#version-table tbody tr'));
            
            statuses.forEach(status => {
                const versionRow = allVersions.find(row => row.cells[5].textContent === status);
                if (versionRow) {
                    const version = versionRow.cells[0].textContent;
                    const date = versionRow.cells[1].textContent;
                    versionSummaryEl.innerHTML += `
                        <div class="flex justify-between items-center">
                            <span class="font-semibold text-gray-600">${labels[status]}</span>
                            <div>
                                ${date ? `<span class="text-xs text-gray-400 mr-2">${date}</span>` : ''}
                                <span class="px-3 py-1 text-sm font-bold rounded-full ${colors[status]}">${version}</span>
                            </div>
                        </div>
                    `;
                }
            });
        }

        function updateRecentCases() {
            const summaryEl = document.getElementById('recent-cases-summary');
            if (!summaryEl) return;
            summaryEl.innerHTML = '';
            
            sampleData['project-cases'].slice(0, 2).forEach(item => {
                const reduction = item.beforeTime > 0 ? (((item.beforeTime - item.afterTime) / item.beforeTime) * 100).toFixed(0) + '%' : '0%';
                summaryEl.innerHTML += `
                     <li class="p-3 bg-white rounded-md text-sm text-gray-600">
                        <span class="font-semibold text-blue-600">${item.owner}:</span> ${item.tool}ë¡œ ${item.task} 
                        <span class="text-red-500 font-bold ml-2">(${reduction} ì ˆê°)</span>
                     </li>
                `;
            });
        }

        // --- Event Handlers ---
        function deleteRow(button, collection, index) {
            if (confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                sampleData[collection].splice(index, 1);
                switch(collection) {
                    case 'project-cases': renderProjectCases(); break;
                    case 'versions': renderVersions(); break;
                    case 'schedules': renderSchedules(); break;
                    case 'surveys': renderSurveys(); break;
                }
            }
        }

        function addRow(collection) {
            const newItem = {};
            sampleData[collection].push(newItem);
            switch(collection) {
                case 'project-cases': renderProjectCases(); break;
                case 'versions': renderVersions(); break;
                case 'schedules': renderSchedules(); break;
                case 'surveys': renderSurveys(); break;
            }
        }

        // --- Initialize on page load ---
        document.addEventListener('DOMContentLoaded', function() {
            renderProjectCases();
            renderVersions();
            renderSchedules();
            renderSurveys();
            updateRecentCases();
        });

        // --- Add row button handlers ---
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('add-row-btn')) {
                const collection = e.target.dataset.collection;
                addRow(collection);
            }
        });

    </script>
</body>
</html> 